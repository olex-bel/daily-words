const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["daily-words/assets/SessionSummary-B1vdKduB.js","daily-words/assets/chunk-WWGJGFF6-BLr-ERng.js","daily-words/assets/index-B4NZ1Im8.js","daily-words/assets/supabase-B_K81v3k.js","daily-words/assets/date-DQzPoZJQ.js","daily-words/assets/ViewCenter-DjUb1wlo.js","daily-words/assets/Surface-DOpK_x3r.js","daily-words/assets/useTranslation-EEi3EmW_.js"])))=>i.map(i=>d[i]);
import{a as h,p as e,B as N,z as k,w as E,x as S}from"./chunk-WWGJGFF6-BLr-ERng.js";import{u as R,R as P,a as C,b as j,c as L,d as $,g as I,M as F}from"./index-B4NZ1Im8.js";import{u as f}from"./useTranslation-EEi3EmW_.js";import"./supabase-B_K81v3k.js";import{S as T}from"./Surface-DOpK_x3r.js";const _="modulepreload",A=function(t){return"/daily-words/"+t},b={},B=function(n,s,r){let l=Promise.resolve();if(s&&s.length>0){let d=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");l=d(s.map(c=>{if(c=A(c),c in b)return;b[c]=!0;const u=c.endsWith(".css"),x=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${x}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":_,u||(m.as="script"),m.crossOrigin="",m.href=c,o&&m.setAttribute("nonce",o),document.head.appendChild(m),u)return new Promise((v,y)=>{m.addEventListener("load",v),m.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return l.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return n().catch(i)})};function W(){const{t}=f(),[n,s]=h.useState(!1),[r,l]=h.useState(null);return{submitRating:async(a,o,d)=>{if(!n){s(!0),l(null);try{await R(a,o),d()}catch{l(t("learning.updateError.message"))}finally{s(!1)}}},isPending:n,error:r,setError:l}}const D={noun:"podst. meno",verb:"sloveso",adj:"príd. meno",particle:"častica",prep:"predložka"};function z({grammar:t}){const n=e.jsx("span",{className:"text-ink-faint",children:"•"});return e.jsxs("div",{className:"flex items-center gap-2 text-ink-light",children:[e.jsx("span",{className:"opacity-50 italic",children:D[t.pos]||t.pos}),t.pos==="verb"&&e.jsxs(e.Fragment,{children:[n,e.jsx("span",{className:"text-ink-faint",children:t.aspect==="pf"?"dok.":"ned."})]}),t.pos==="noun"&&e.jsxs(e.Fragment,{children:[n,e.jsx("span",{className:"text-sky-600",children:t.gender}),t.genitive&&e.jsxs(e.Fragment,{children:[n,e.jsxs("span",{className:"lowercase opacity-70",children:["G: -",t.genitive.slice(-2)]})]}),t.plural&&e.jsxs(e.Fragment,{children:[n,e.jsxs("span",{className:"lowercase opacity-70",children:["PL: -",t.plural.slice(-2)]})]})]})]})}const p={m:{bg:"bg-word-masculine",text:"text-word-masculine",shadow:"shadow-word-masculine",border:"border-word-masculine"},f:{bg:"bg-word-feminine",text:"text-word-feminine",shadow:"shadow-word-feminine",border:"border-word-feminine"},n:{bg:"bg-word-neutral",text:"text-word-neutral",shadow:"shadow-word-neutral",border:"border-word-neutral"},action:{bg:"bg-word-action",text:"text-word-action",shadow:"shadow-word-action",border:"border-word-action"},default:{bg:"bg-gray-500",text:"text-gray-500",shadow:"shadow-gray-200",border:"border-gray-500"}};function w(t){return t.pos==="noun"?p[t.gender]??p.default:t.pos==="verb"?p.action:p.default}function M({grammar:t}){const n=w(t);return e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx("div",{className:`h-4 w-1 rounded-full ${n.bg}`}),e.jsx("div",{className:"flex gap-2 text-[clamp(0.6rem,1vw,0.7rem)] font-black tracking-widest uppercase",children:e.jsx(z,{grammar:t})})]})}function g({className:t="",children:n,variant:s,icon:r,...l}){let i="";return s==="primary"?i="bg-primary text-white hover:brightness-90":i="",r&&(t+=" inline-flex items-center"),e.jsxs("button",{...l,className:`rounded-md font-semibold transition-all active:scale-95 shadow-sm ${t} ${i}`,children:[r&&e.jsx("span",{className:"mr-2 inline-flex",children:r}),n]})}function O({url:t,className:n}){const[s,r]=h.useState(!1),{t:l}=f();if(!t)return null;const i=a=>{a.preventDefault(),a.stopPropagation();const o=new Audio(t);r(!0),o.play(),o.onended=()=>r(!1),o.onerror=()=>r(!1)};return e.jsx("button",{onClick:i,className:`p-2 rounded-full transition-colors ${n||""} ${s?"text-sky-500 bg-sky-50":"text-slate-400 hover:text-sky-600 hover:bg-slate-100"}`,title:l("learning.audioTitle"),children:s?e.jsx(P,{className:"w-6 h-6"}):e.jsx(C,{className:"w-6 h-6"})})}function U({entry:t,onShowTranslation:n}){const{t:s}=f(),{content:r,grammar:l,example:i,audio_url:a}=t,o=w(l);return e.jsxs("div",{className:`h-full flex flex-col backface-hidden p-4 rotate-x-0 shadow-md ${o.shadow}`,children:[e.jsx(M,{grammar:l}),e.jsx("div",{className:"uppercase text-4xl md:text-5xl font-extrabold text-ink text-center",children:r}),e.jsx("div",{className:"flex-grow flex justify-center items-center",children:e.jsx("p",{className:"font-serif text-lg md:text-xl italic text-ink-light leading-relaxed",children:i})}),e.jsx("div",{className:"h-10 flex justify-center flex-none",children:a&&e.jsx(O,{url:a})}),e.jsx(g,{variant:"primary",className:"py-2 w-8/9 mx-auto block mt-8",onClick:n,children:s("learning.showTranslation")})]})}function q({entry:t}){const{content:n,meanings:s,grammar:r}=t,l=w(r);return e.jsxs("div",{className:`absolute inset-0 flex flex-col backface-hidden p-4 rotate-x-180 shadow-md ${l.shadow}`,children:[e.jsx("div",{className:"uppercase text-3xl md:text-4xl font-extrabold text-ink text-center mb-4 md:mb-6",children:n}),e.jsx("div",{className:"space-y-4 flex-grow overflow-y-auto pr-3",children:s.map((i,a)=>e.jsxs("div",{className:`border-l-4 pl-4 py-1 transition-all hover:translate-x-1 ${l.border}`,children:[e.jsx("p",{className:"text-lg md:text-xl font-bold leading-tight",children:i.val}),e.jsx("p",{className:"text-sm text-slate-500 italic mt-1",children:i.context})]},a))})]})}function G({entry:t}){const[n,s]=h.useState(!1);return e.jsx("article",{className:"w-full max-w-md min-h-[280px] md:min-h-[320px] perspective-distant",children:e.jsxs(T,{className:`relative transform-3d transition-transform duration-700 w-full h-full ${n?"rotate-x-180":""}`,children:[e.jsx(U,{entry:t,onShowTranslation:()=>s(!0)}),e.jsx(q,{entry:t})]})})}function Y({entry:t,onAnswer:n}){const{t:s}=f();return e.jsxs(e.Fragment,{children:[e.jsx(G,{entry:t},t.id),e.jsxs("div",{className:"grid grid-flow-col auto-cols-fr gap-4 mt-6 md:mt-8 text-xs md:text-sm",children:[e.jsx(g,{className:"bg-white border-1 border-red-100 hover:bg-red-50 text-red-600 transition-all active:scale-95 px-4 py-2",onClick:()=>n(t.id,"unknown"),icon:e.jsx(j,{}),children:s("learning.unknownButton")}),e.jsx(g,{className:"bg-white border-1 border-orange-100 hover:bg-orange-50 text-orange-600 transition-all active:scale-95 px-4 py-2",onClick:()=>n(t.id,"hard"),icon:e.jsx(L,{}),children:s("learning.hardButton")}),e.jsx(g,{className:"bg-white border-1 border-green-100 hover:bg-green-50 text-green-600 transition-all active:scale-95 px-4 py-2",onClick:()=>n(t.id,"know"),icon:e.jsx($,{}),children:s("learning.knownButton")})]})]})}function H({value:t,max:n,className:s=""}){const r=t/n*100,l=`hsl(${100+r*.4}, 70%, 50%)`;return e.jsx("div",{className:`h-3 bg-gray-200 rounded-full overflow-hidden shadow-sm ${s}`,children:e.jsx("div",{className:"h-full transition-all duration-500 ease-out",style:{width:`${r}%`,backgroundColor:l}})})}function V({children:t,onClose:n,type:s="error"}){h.useEffect(()=>{const l=setTimeout(n,5e3);return()=>clearTimeout(l)},[n]);const r=s==="error"?"bg-red-600":"bg-green-600";return e.jsxs("div",{className:`absolute top-4 left-1/2 -translate-x-1/2 z-50 ${r} text-white px-4 py-3 rounded-lg shadow-2xl flex items-center justify-between min-w-[280px]`,children:[e.jsx("div",{className:"flex-grow text-sm font-medium",children:t}),e.jsx("button",{onClick:n,className:"ml-3 p-1 hover:bg-black/10 rounded-full transition-colors","aria-label":"Close",children:e.jsx(j,{size:18})})]})}const X=h.lazy(()=>B(()=>import("./SessionSummary-B1vdKduB.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),J=(t,n)=>{if(n.type==="ANSWER"){const{answer:s,isLast:r}=n.payload;return{...t,[s]:t[s]+1,completed:r,currentIndex:r?t.currentIndex:t.currentIndex+1}}else return t};function K({words:t}){const{error:n,setError:s,submitRating:r}=W(),{t:l}=f(),i=N(),[a,o]=h.useReducer(J,{know:0,hard:0,unknown:0,currentIndex:0,completed:!1}),d=t.length,c=async(u,x)=>{r(u,x,()=>{o({type:"ANSWER",payload:{answer:x,isLast:a.currentIndex+1>=d}})})};return e.jsxs("div",{className:"relative flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 md:p-4",children:[e.jsx(k,{to:"/dashboard",className:"no-underline hover:underline",children:l("learning.finishButton")}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(H,{value:a.currentIndex+1,max:d,className:"w-24 md:w-40"}),a.completed?e.jsxs("span",{className:"text-green-600 flex items-center gap-1",children:[d," / ",d]}):e.jsxs("span",{children:[a.currentIndex+1," / ",d]})]})]}),e.jsx("div",{className:"flex-grow flex flex-col justify-center items-center",children:a.completed?e.jsx(h.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsx(X,{total:d,results:a,onRepeat:()=>{},onExit:()=>i("/dashboard")})}):e.jsx(Y,{entry:t[a.currentIndex],onAnswer:c})}),n&&e.jsx(V,{onClose:()=>s(null),children:n})]})}async function se(){const t=await I(F);return t.length===0?S("/dashboard"):{words:t}}const re=E(function({loaderData:n}){const{t:s}=f(),{words:r}=n;return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:s("learning.meta.title")}),e.jsx("meta",{name:"description",content:s("learning.meta.description")}),e.jsx("meta",{name:"keywords",content:s("learning.meta.keywords")}),e.jsx(K,{words:r})]})});export{g as B,se as c,re as l};
