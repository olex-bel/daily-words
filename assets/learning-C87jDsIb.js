const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SessionSummary-BDTkExnD.js","./chunk-WWGJGFF6-8djDTm2d.js","./index-DKhaMfTd.js","./supabase-B_K81v3k.js","./date-C38ZJWcO.js","./ViewCenter-CjFryxq8.js","./Surface-Br18wGdW.js","./useTranslation-YS5tDbaE.js"])))=>i.map(i=>d[i]);
import{a as u,p as e,B as R,z as S,w as C,x as L,C as P}from"./chunk-WWGJGFF6-8djDTm2d.js";import{u as $,R as I,a as F,b as N,c as k,d as A,e as B,g as T,M as _}from"./index-DKhaMfTd.js";import{u as h}from"./useTranslation-YS5tDbaE.js";import"./supabase-B_K81v3k.js";import{S as E}from"./Surface-Br18wGdW.js";import{V as W}from"./ViewCenter-CjFryxq8.js";const D="modulepreload",z=function(t,s){return new URL(t,s).href},y={},M=function(s,n,r){let l=Promise.resolve();if(n&&n.length>0){let w=function(c){return Promise.all(c.map(x=>Promise.resolve(x).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};const a=document.getElementsByTagName("link"),i=document.querySelector("meta[property=csp-nonce]"),d=i?.nonce||i?.getAttribute("nonce");l=w(n.map(c=>{if(c=z(c,r),c in y)return;y[c]=!0;const x=c.endsWith(".css"),f=x?'[rel="stylesheet"]':"";if(r)for(let p=a.length-1;p>=0;p--){const j=a[p];if(j.href===c&&(!x||j.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${f}`))return;const m=document.createElement("link");if(m.rel=x?"stylesheet":D,x||(m.as="script"),m.crossOrigin="",m.href=c,d&&m.setAttribute("nonce",d),document.head.appendChild(m),x)return new Promise((p,j)=>{m.addEventListener("load",p),m.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(a){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=a,window.dispatchEvent(i),!i.defaultPrevented)throw a}return l.then(a=>{for(const i of a||[])i.status==="rejected"&&o(i.reason);return s().catch(o)})};function O(){const{t}=h(),[s,n]=u.useState(!1),[r,l]=u.useState(null);return{submitRating:async(a,i,d)=>{if(!s){n(!0),l(null);try{await $(a,i),d()}catch{l(t("learning.updateError.message"))}finally{n(!1)}}},isPending:s,error:r,setError:l}}const V={noun:"podst. meno",verb:"sloveso",adj:"príd. meno",particle:"častica",prep:"predložka"};function q({grammar:t}){const s=e.jsx("span",{className:"text-ink-faint",children:"•"});return e.jsxs("div",{className:"flex items-center gap-2 text-ink-light",children:[e.jsx("span",{className:"opacity-50 italic",children:V[t.pos]||t.pos}),t.pos==="verb"&&e.jsxs(e.Fragment,{children:[s,e.jsx("span",{className:"text-ink-faint",children:t.aspect==="pf"?"dok.":"ned."})]}),t.pos==="noun"&&e.jsxs(e.Fragment,{children:[s,e.jsx("span",{className:"text-sky-600",children:t.gender}),t.genitive&&e.jsxs(e.Fragment,{children:[s,e.jsxs("span",{className:"lowercase opacity-70",children:["G: -",t.genitive.slice(-2)]})]}),t.plural&&e.jsxs(e.Fragment,{children:[s,e.jsxs("span",{className:"lowercase opacity-70",children:["PL: -",t.plural.slice(-2)]})]})]})]})}const b={m:{bg:"bg-word-masculine",text:"text-word-masculine",shadow:"shadow-word-masculine",border:"border-word-masculine"},f:{bg:"bg-word-feminine",text:"text-word-feminine",shadow:"shadow-word-feminine",border:"border-word-feminine"},n:{bg:"bg-word-neutral",text:"text-word-neutral",shadow:"shadow-word-neutral",border:"border-word-neutral"},action:{bg:"bg-word-action",text:"text-word-action",shadow:"shadow-word-action",border:"border-word-action"},default:{bg:"bg-gray-500",text:"text-gray-500",shadow:"shadow-gray-200",border:"border-gray-500"}};function v(t){return t.pos==="noun"?b[t.gender]??b.default:t.pos==="verb"?b.action:b.default}function G({grammar:t}){const s=v(t);return e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx("div",{className:`h-4 w-1 rounded-full ${s.bg}`}),e.jsx("div",{className:"flex gap-2 text-[clamp(0.6rem,1vw,0.7rem)] font-black tracking-widest uppercase",children:e.jsx(q,{grammar:t})})]})}function g({className:t="",children:s,variant:n,icon:r,...l}){let o="";return n==="primary"?o="bg-primary text-white hover:brightness-90":o="",r&&(t+=" inline-flex items-center"),e.jsxs("button",{...l,className:`rounded-md font-semibold transition-all active:scale-95 shadow-sm ${t} ${o}`,children:[r&&e.jsx("span",{className:"mr-2 inline-flex",children:r}),s]})}function U({url:t,className:s}){const[n,r]=u.useState(!1),{t:l}=h();if(!t)return null;const o=a=>{a.preventDefault(),a.stopPropagation();const i=new Audio(t);r(!0),i.play(),i.onended=()=>r(!1),i.onerror=()=>r(!1)};return e.jsx("button",{onClick:o,className:`p-2 rounded-full transition-colors ${s||""} ${n?"text-sky-500 bg-sky-50":"text-slate-400 hover:text-sky-600 hover:bg-slate-100"}`,title:l("learning.audioTitle"),children:n?e.jsx(I,{className:"w-6 h-6"}):e.jsx(F,{className:"w-6 h-6"})})}function Y({entry:t,onShowTranslation:s}){const{t:n}=h(),{content:r,grammar:l,example:o,audio_url:a}=t,i=v(l);return e.jsxs("div",{className:`h-full flex flex-col backface-hidden p-4 rotate-x-0 shadow-md ${i.shadow}`,children:[e.jsx(G,{grammar:l}),e.jsx("div",{className:"uppercase text-4xl md:text-5xl font-extrabold text-ink text-center",children:r}),e.jsx("div",{className:"flex-grow flex justify-center items-center",children:e.jsx("p",{className:"font-serif text-lg md:text-xl italic text-ink-light leading-relaxed",children:o})}),e.jsx("div",{className:"h-10 flex justify-center flex-none",children:a&&e.jsx(U,{url:a})}),e.jsx(g,{variant:"primary",className:"py-2 w-8/9 mx-auto block mt-8",onClick:s,children:n("learning.showTranslation")})]})}function H({entry:t}){const{content:s,meanings:n,grammar:r}=t,l=v(r);return e.jsxs("div",{className:`absolute inset-0 flex flex-col backface-hidden p-4 rotate-x-180 shadow-md ${l.shadow}`,children:[e.jsx("div",{className:"uppercase text-3xl md:text-4xl font-extrabold text-ink text-center mb-4 md:mb-6",children:s}),e.jsx("div",{className:"space-y-4 flex-grow overflow-y-auto pr-3",children:n.map((o,a)=>e.jsxs("div",{className:`border-l-4 pl-4 py-1 transition-all hover:translate-x-1 ${l.border}`,children:[e.jsx("p",{className:"text-lg md:text-xl font-bold leading-tight",children:o.val}),e.jsx("p",{className:"text-sm text-slate-500 italic mt-1",children:o.context})]},a))})]})}function X({entry:t}){const[s,n]=u.useState(!1);return e.jsx("article",{className:"w-full max-w-md min-h-[280px] md:min-h-[320px] perspective-distant",children:e.jsxs(E,{className:`relative transform-3d transition-transform duration-700 w-full h-full ${s?"rotate-x-180":""}`,children:[e.jsx(Y,{entry:t,onShowTranslation:()=>n(!0)}),e.jsx(H,{entry:t})]})})}function J({entry:t,onAnswer:s}){const{t:n}=h();return e.jsxs(e.Fragment,{children:[e.jsx(X,{entry:t},t.id),e.jsxs("div",{className:"grid grid-flow-col auto-cols-fr gap-4 mt-6 md:mt-8 text-xs md:text-sm",children:[e.jsx(g,{className:"bg-white border-1 border-red-100 hover:bg-red-50 text-red-600 transition-all active:scale-95 px-4 py-2",onClick:()=>s(t.id,"unknown"),icon:e.jsx(N,{}),children:n("learning.unknownButton")}),e.jsx(g,{className:"bg-white border-1 border-orange-100 hover:bg-orange-50 text-orange-600 transition-all active:scale-95 px-4 py-2",onClick:()=>s(t.id,"hard"),icon:e.jsx(k,{}),children:n("learning.hardButton")}),e.jsx(g,{className:"bg-white border-1 border-green-100 hover:bg-green-50 text-green-600 transition-all active:scale-95 px-4 py-2",onClick:()=>s(t.id,"know"),icon:e.jsx(A,{}),children:n("learning.knownButton")})]})]})}function K({value:t,max:s,className:n=""}){const r=t/s*100,l=`hsl(${100+r*.4}, 70%, 50%)`;return e.jsx("div",{className:`h-3 bg-gray-200 rounded-full overflow-hidden shadow-sm ${n}`,children:e.jsx("div",{className:"h-full transition-all duration-500 ease-out",style:{width:`${r}%`,backgroundColor:l}})})}function Q({children:t,onClose:s,type:n="error"}){u.useEffect(()=>{const l=setTimeout(s,5e3);return()=>clearTimeout(l)},[s]);const r=n==="error"?"bg-red-600":"bg-green-600";return e.jsxs("div",{className:`absolute top-4 left-1/2 -translate-x-1/2 z-50 ${r} text-white px-4 py-3 rounded-lg shadow-2xl flex items-center justify-between min-w-[280px]`,children:[e.jsx("div",{className:"flex-grow text-sm font-medium",children:t}),e.jsx("button",{onClick:s,className:"ml-3 p-1 hover:bg-black/10 rounded-full transition-colors","aria-label":"Close",children:e.jsx(N,{size:18})})]})}const Z=u.lazy(()=>M(()=>import("./SessionSummary-BDTkExnD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url)),ee=(t,s)=>{if(s.type==="ANSWER"){const{answer:n,isLast:r}=s.payload;return{...t,[n]:t[n]+1,completed:r,currentIndex:r?t.currentIndex:t.currentIndex+1}}else return t};function te({words:t}){const{error:s,setError:n,submitRating:r}=O(),{t:l}=h(),o=R(),[a,i]=u.useReducer(ee,{know:0,hard:0,unknown:0,currentIndex:0,completed:!1}),d=t.length,w=async(c,x)=>{r(c,x,()=>{i({type:"ANSWER",payload:{answer:x,isLast:a.currentIndex+1>=d}})})};return e.jsxs("div",{className:"relative flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 md:p-4",children:[e.jsx(S,{to:"/dashboard",className:"no-underline hover:underline",children:l("learning.finishButton")}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(K,{value:a.currentIndex+1,max:d,className:"w-24 md:w-40"}),a.completed?e.jsxs("span",{className:"text-green-600 flex items-center gap-1",children:[d," / ",d]}):e.jsxs("span",{children:[a.currentIndex+1," / ",d]})]})]}),e.jsx("div",{className:"flex-grow flex flex-col justify-center items-center",children:a.completed?e.jsx(u.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsx(Z,{total:d,results:a,onRepeat:()=>{},onExit:()=>o("/dashboard")})}):e.jsx(J,{entry:t[a.currentIndex],onAnswer:w})}),s&&e.jsx(Q,{onClose:()=>n(null),children:s})]})}function se(){const{t}=h();return e.jsx(W,{children:e.jsx(E,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center h-full gap-6",children:[e.jsx("div",{className:"mb-4 p-4 bg-orange-50 rounded-full",children:e.jsx(k,{className:"text-5xl text-orange-500"})}),e.jsx("p",{className:"text-lg",children:t("learning.loadError.message")}),e.jsx(g,{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-white text-primary hover:brightness-90",icon:e.jsx(B,{}),children:t("learning.loadError.retryButton")})]})})})}async function ce(){const t=T(_);return t||L("/dashboard"),{words:t}}const de=C(function({loaderData:s}){const{t:n}=h();return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:n("learning.meta.title")}),e.jsx("meta",{name:"description",content:n("learning.meta.description")}),e.jsx("meta",{name:"keywords",content:n("learning.meta.keywords")}),e.jsx(u.Suspense,{fallback:e.jsx("div",{className:"h-full flex justify-center items-center",children:"Loading..."}),children:e.jsx(P,{resolve:s.words,errorElement:e.jsx(se,{}),children:r=>e.jsx(te,{words:r})})})]})});export{g as B,ce as c,de as l};
