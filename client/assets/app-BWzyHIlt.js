import{w as m,x as o,A as Q,a as U,p as d,O as C}from"./chunk-WWGJGFF6-8djDTm2d.js";import{s as l}from"./supabase-B_K81v3k.js";import{g as p}from"./profileService-CnHYnD1-.js";import"./date-C38ZJWcO.js";function g(a,e){const s=(async(...t)=>{if(typeof window>"u")return a(...t);const i=typeof e.key=="function"?e.key(...t):e.key;try{const I=sessionStorage.getItem(i);if(I){const r=JSON.parse(I);if(!r.expiresAt||r.expiresAt>Date.now())return r.data;sessionStorage.removeItem(i)}}catch{}const n=await a(...t);try{const I={data:n,expiresAt:e.ttlMs?Date.now()+e.ttlMs:void 0};sessionStorage.setItem(i,JSON.stringify(I))}catch{}return n});return s.invalidate=(...t)=>{const i=typeof e.key=="function"?e.key(...t):e.key;sessionStorage.removeItem(i)},s}const c=g(async a=>p(a),{key:a=>`user_profile_${a}`,ttlMs:1800*1e3}),Z="data:image/svg+xml;base64,PCEtLSBDcmVhdGVkIHdpdGggUGl4aUVkaXRvciAoaHR0cHM6Ly9waXhpZWRpdG9yLm5ldCkgLS0+CjxzdmcgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgMTIwIDQwIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8aW1hZ2UgeD0iMCIgeT0iMCIgd2lkdGg9IjEyMCIgaGVpZ2h0PSI0MCIgeGxpbms6aHJlZj0iZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFIZ0FBQUFvRUFZQUFBQmxldUptQUFBQUFYTlNSMElBcnM0YzZRQUFBQVJ6UWtsVUVCQVFFR3JuNlQ4QUFBQ1lTVVJCVkhpYzdkT3hEWUJBRE1CQVlQK2RNbFhxWndjYVpPbHVBamUrZDNaMnpybUFuT2Z2QU9BN0EwT1lnU0hNd0JCbVlBZ3pNSVFaR01JTURHRUdoakFEUTVpQkljekFFR1pnQ0RNd2hCa1l3Z3dNWVFhR01BTkRtSUVoek1BUVptQUlNekNFR1JqQ0RBeGhCb1l3QTBPWWdTSE13QkJtWUFnek1JUVpHTUlNREdFR2hqQURRNWlCSWN6QUVHWmdDRE13aEJrWXdsNkQxQWRxMGF3LzdBQUFBQUJKUlU1RXJrSmdnZz09IiBpbWFnZS1yZW5kZXJpbmc9InBpeGVsYXRlZCIgaWQ9ItCR0LDQt9C+0LLQuNC5INGI0LDRgCIgLz4KICA8aW1hZ2UgeD0iMCIgeT0iMCIgd2lkdGg9IjEyMCIgaGVpZ2h0PSI0MCIgeGxpbms6aHJlZj0iZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFIZ0FBQUFvRUFZQUFBQmxldUptQUFBQUFYTlNSMElBcnM0YzZRQUFBQVJ6UWtsVUVCQVFFR3JuNlQ4QUFBQ1lTVVJCVkhpYzdkT3hEWUJBRE1CQVlQOGRNMFhxWndjYVpPbHVBamUrZDNaMnpybUFuT2Z2QU9BN0EwT1lnU0hNd0JCbVlBZ3pNSVFaR01JTURHRUdoakFEUTVpQkljekFFR1pnQ0RNd2hCa1l3Z3dNWVFhR01BTkRtSUVoek1BUVptQUlNekNFR1JqQ0RBeGhCb1l3QTBPWWdTSE13QkJtWUFnek1JUVpHTUlNREdFR2hqQURRNWlCSWN6QUVHWmdDRE13aEJrWXdsN1VuQWZLaCtUQWpBQUFBQUJKUlU1RXJrSmdnZz09IiBpbWFnZS1yZW5kZXJpbmc9InBpeGVsYXRlZCIgaWQ9ItCd0L7QstC40Lkg0YjQsNGAIDEiIC8+CiAgPHRleHQgeD0iMzQuNTAzNDQ1MTA3OTQ2NzIiIHk9IjI2LjkxMjI2NDU4NDI5MDMxIiBmb250LXNpemU9IjIwIiBmb250LWZhbWlseT0iSW50ZXIiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIGZvbnQtc3R5bGU9Im5vcm1hbCIgdHJhbnNmb3JtPSJtYXRyaXgoMSwgMCwgMCwgMSwgMCwgMCkiIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMSIgc3Ryb2tlPSIjMjk1YmEzIiBzdHJva2Utd2lkdGg9IjAiIG9wYWNpdHk9IjEiIGlkPSLQotC10LrRgdGCIj48L3RleHQ+CiAgPHRleHQgeD0iMTEuNDYyNTYzMTYwMzEyMzU3IiB5PSIyMi40ODU5ODk4OTQzNTAwMjMiIGZvbnQtc2l6ZT0iMjAiIGZvbnQtZmFtaWx5PSJJbnRlciIgZm9udC13ZWlnaHQ9Im5vcm1hbCIgZm9udC1zdHlsZT0ibm9ybWFsIiB0cmFuc2Zvcm09Im1hdHJpeCgwLjk5OTk5OTk0LCAwLCAwLCAxLCAtNS43ODA2NjA2LCAzLjUxNDAxKSIgZmlsbD0iI2Y1NDkwMCIgZmlsbC1vcGFjaXR5PSIxIiBzdHJva2U9IiNlNzZkMGEiIHN0cm9rZS13aWR0aD0iMCIgb3BhY2l0eT0iMSIgaWQ9ItCi0LXQutGB0YIiPkRhaWx5PC90ZXh0PgogIDx0ZXh0IHg9IjUzLjM2MDU4Nzk2NTA4OTU3IiB5PSIyNC42Njg4MTAyODkzODkwNjgiIGZvbnQtc2l6ZT0iMjAiIGZvbnQtZmFtaWx5PSJJbnRlciIgZm9udC13ZWlnaHQ9Im5vcm1hbCIgZm9udC1zdHlsZT0ibm9ybWFsIiB0cmFuc2Zvcm09Im1hdHJpeCgxLCAwLCAwLCAxLCAwLjE4MTkwMDAyLCAyLjI0MzQ1NCkiIGZpbGw9IiMwMDg0ZDEiIGZpbGwtb3BhY2l0eT0iMSIgc3Ryb2tlPSIjMDA4NGQxIiBzdHJva2Utd2lkdGg9IjAiIG9wYWNpdHk9IjEiIGlkPSLQotC10LrRgdGCIj5Xb3JkczwvdGV4dD4KPC9zdmc+";async function F({request:a}){const{data:{session:e},error:s}=await l.auth.getSession();if(!e||s){const i=new URLSearchParams;return i.set("from",new URL(a.url).pathname),o(`/signin?${i.toString()}`)}const t=await c(e.user.id);if(!t)throw new Response("User profile not found",{status:404});return{session:e,profile:t}}const u=a=>{let e;return l.auth.onAuthStateChange((s,t)=>{t?.user?.id!=e?.user?.id&&(e&&c.invalidate(e.user.id),e=t,a(s))})},k=m(function({loaderData:e}){const s=Q(),{profile:t}=e;return U.useEffect(()=>{const{data:i}=u(n=>{(n==="SIGNED_IN"||n==="SIGNED_OUT")&&s.revalidate()});return()=>{i?.subscription?.unsubscribe&&i.subscription.unsubscribe()}},[s]),d.jsxs(d.Fragment,{children:[d.jsx("header",{className:"bg-surface shadow-sm h-[50px] md:h-[70px] flex items-center",children:d.jsx("div",{className:"w-[90%] max-w-5xl mx-auto flex items-center",children:d.jsx("img",{src:Z,alt:"DailyWords Logo",className:"h-8 md:h-10 drop-shadow-md rounded-t-xl rounded-br-xl"})})}),d.jsx("main",{className:"w-[90%] max-w-5xl mx-auto",children:d.jsx(C,{context:{profile:t}})}),d.jsx("footer",{className:"text-center py-2 text-sm text-gray-500",children:"Â© 2026 DailyWords"})]})});export{F as clientLoader,k as default};
